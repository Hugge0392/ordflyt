<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Substantiv - del 1 </title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #f59e0b 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .speech-bubble {
            position: relative;
            background: #f3f4f6;
            border-radius: 8px;
            padding: 24px;
        }
        
        .speech-bubble::after {
            content: '';
            position: absolute;
            right: -8px;
            top: 24px;
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-left: 8px solid #f3f4f6;
        }
        
        .typewriter {
            overflow: hidden;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lesson data embedded
        const lessonData = {
  "title": "Substantiv - del 1 ",
  "moments": [
    {
      "id": "merged1_1755383020389_0",
      "type": "pratbubbla",
      "order": 0,
      "title": "Pratbubbla",
      "config": {
        "items": [
          {
            "id": "item-1",
            "type": "text",
            "order": 1,
            "content": "Hall√• p√• dig, landkrabba!"
          },
          {
            "id": "item-1755375850475",
            "type": "text",
            "order": 2,
            "content": "Jag heter Kapten Matilda och jag styr den h√§r substantivskutan! üè¥‚Äç‚ò†Ô∏è \nAlla p√• mitt skepp √ÑLSKAR substantiv. "
          },
          {
            "id": "item-1755375851635",
            "type": "text",
            "order": 3,
            "content": "Varf√∂r det, tror du? "
          },
          {
            "id": "item-1755375851794",
            "type": "text",
            "order": 4,
            "content": "Jo, vi pirater gillar saker mer √§n allt annat ‚Äì och substantiv och saker h√∂r ihop som kniv och gaffel! "
          },
          {
            "id": "item-1755375851964",
            "type": "text",
            "order": 5,
            "content": "Vad √§r d√• ett substantiv?\n\nEtt substantiv √§r ett ord som ber√§ttar vad saker, personer, djur, platser eller k√§nslor heter. Jag heter till exempel Matilda och mitt namn √§r ett substantiv. Jag har ocks√• en hatt p√• mig och det √§r ocks√• ett ord som √§r ett substantiv. "
          },
          {
            "id": "item-1755375852121",
            "type": "text",
            "order": 6,
            "content": "Andra exempel p√• substantiv kan vara:\n\nSaker: boll, bord, dator \n\nPersoner: Erik, Matilda, Tomas\n\nDjur: katt, ko, fisk, papegoja\n\nPlatser: Stockholm, skogen, havet, simhallen\n\nK√§nslor: gl√§dje, k√§rlek, ilska"
          },
          {
            "id": "item-1755375852360",
            "type": "text",
            "order": 7,
            "content": "üëâ Kom ih√•g denna lilla ramsa: \n‚ÄúSubstantiv √§r namn p√• ting, som stol, katt och en ring.‚Äù "
          },
          {
            "id": "item-1755376105582",
            "type": "question",
            "order": 8,
            "content": "F√•r se kommer du ih√•g?\n\nVilket av dessa ord √§r ett substantiv?",
            "alternatives": [
              {
                "text": "Boll",
                "correct": true
              },
              {
                "text": "Simmade",
                "correct": false
              }
            ],
            "correctFeedback": "R√§tt svar: Boll - f√∂r det √§r ju ett namn p√• en sak. Bra d√§r!",
            "incorrectFeedback": "Tyv√§rr fel... Simma √§r ju n√•got man g√∂r och det √§r inte ett substantiv (verb)"
          },
          {
            "id": "item-1755383608528",
            "type": "question",
            "order": 9,
            "content": "Vilket ord √§r substantivet",
            "alternatives": [
              {
                "text": "Kanske",
                "correct": false
              },
              {
                "text": "N√§r",
                "correct": false
              },
              {
                "text": "Bok",
                "correct": true
              },
              {
                "text": "Usch!",
                "correct": false
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          },
          {
            "id": "item-1755376261972",
            "type": "text",
            "order": 10,
            "content": "Nu verkar du f√• lite koll, eller som vi s√§ger \"f√• sj√∂ben\". \n\nJag har b√•de en katt och en papegoja. B√•da √§r v√§ldigt trevliga! üê±ü¶ú\nNamn p√• djur √§r ocks√• substantiv.\n\nExempel:\n\nKatt, ko, √•sna, kamel, fj√§ril, fisk."
          },
          {
            "id": "item-1755384675065",
            "type": "question",
            "order": 11,
            "content": "Vad √§r substantivet i denna mening?\n\nAj! Min katt bet mig!",
            "alternatives": [
              {
                "text": "Aj!",
                "correct": false
              },
              {
                "text": "Min",
                "correct": false
              },
              {
                "text": "Katt",
                "correct": true
              },
              {
                "text": "Bet",
                "correct": false
              },
              {
                "text": "Mig",
                "correct": false
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          },
          {
            "id": "item-1755384729408",
            "type": "question",
            "order": 12,
            "content": "Vad √§r substantivet i denna mening?\n\nKr√§ftan l√•g bara d√§r",
            "alternatives": [
              {
                "text": "Kr√§ftan",
                "correct": true
              },
              {
                "text": "L√•g",
                "correct": false
              },
              {
                "text": "Bara",
                "correct": false
              },
              {
                "text": "D√§r",
                "correct": false
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          }
        ],
        "animationSpeed": 25,
        "characterImage": "/@fs/home/runner/workspace/attached_assets/Pirat%20h%C3%B6ger_1755326212023.png"
      }
    },
    {
      "id": "merged1_1755383020389_1",
      "type": "pratbubbla",
      "order": 1,
      "title": "Pratbubbla",
      "config": {
        "items": [
          {
            "id": "item-1",
            "type": "text",
            "order": 1,
            "content": "Topp! Nu har du koll p√• att namn b√•de levande varelser och saker √§r substantiv. \n\nDet finns √§ven andra grejer som √§r substantiv. \n\nAlla namn p√• m√§nniskor √§r substantiv: Erik, Sara, Greta, Kondrad, Matilda\n\n√Ñven alla namn p√• platser √§r substantiv: Simhallen, Malm√∂, men √§ven ord som skogen och havet. "
          },
          {
            "id": "item-1755384109366",
            "type": "text",
            "order": 4,
            "content": "Jag kanske kommer fr√•n S√∂derhavet och du fr√•n n√•gon helt annan plats.\nMen en sak √§r s√§ker: namnet p√• en plats √§r alltid ett substantiv!\n\nExempel p√• st√§der:\nStockholm\nG√§vle\nFalun\n\nMen √§ven mindre st√§llen √§r ocks√• exempel p√• substantiv:\nRidhuset\nSimhallen\nGretas grill"
          },
          {
            "id": "item-1755383941466",
            "type": "question",
            "order": 5,
            "content": "Vilket ord i denna mening √§r ett substantiv?\n\nVi √•kte till G√∂teborg",
            "alternatives": [
              {
                "text": "Vi",
                "correct": false
              },
              {
                "text": "√Ökte",
                "correct": false
              },
              {
                "text": "Till",
                "correct": false
              },
              {
                "text": "G√∂teborg",
                "correct": true
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          },
          {
            "id": "item-1755384018937",
            "type": "question",
            "order": 6,
            "content": "Vilket ord i denna mening √§r ett substantiv?\n\nNej! Ridhuset har st√§ngt",
            "alternatives": [
              {
                "text": "Nej!",
                "correct": false
              },
              {
                "text": "Ridhuset",
                "correct": true
              },
              {
                "text": "Har",
                "correct": false
              },
              {
                "text": "St√§ngt",
                "correct": false
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          },
          {
            "id": "item-1755377657324",
            "type": "text",
            "order": 7,
            "content": "Nu ska vi se ifall du kan gr√§va upp ett par skatter som jag har g√∂mt... "
          }
        ],
        "animationSpeed": 25,
        "characterImage": "/@fs/home/runner/workspace/attached_assets/Pirat%20h%C3%B6ger_1755326212023.png"
      }
    },
    {
      "id": "merged1_1755383020389_2",
      "type": "piratgrav",
      "order": 2,
      "title": "Piratgr√§v",
      "config": {
        "words": [
          {
            "n": true,
            "w": "Matilda"
          },
          {
            "n": false,
            "w": "Springa"
          },
          {
            "n": true,
            "w": "Stockholm"
          },
          {
            "n": false,
            "w": "R√∂d"
          },
          {
            "n": true,
            "w": "Tomas"
          },
          {
            "n": false,
            "w": "Sn√§ll"
          },
          {
            "n": true,
            "w": "Katt"
          },
          {
            "n": false,
            "w": "Gr√∂n"
          },
          {
            "n": true,
            "w": "B√∂cker"
          },
          {
            "n": false,
            "w": "D√•lig"
          },
          {
            "n": true,
            "w": "Simhall"
          },
          {
            "n": false,
            "w": "Eller"
          }
        ],
        "instruction": "Gr√§v fram ord och avg√∂r om de √§r substantiv"
      }
    },
    {
      "id": "merged1_1755383020389_3",
      "type": "pratbubbla",
      "order": 3,
      "title": "Pratbubbla",
      "config": {
        "items": [
          {
            "id": "item-1",
            "type": "text",
            "order": 1,
            "content": "Jag m√•r lite d√•ligt... Det k√§nns som jag h√•ller p√• att bli sj√∂sjuk!\nSj√∂sjuka √§r en obehaglig k√§nsla ‚Äì och namn p√• k√§nslor √§r ocks√• substantiv."
          },
          {
            "id": "item-1755379557807",
            "type": "text",
            "order": 2,
            "content": "K√§nslor som gl√§dje, ilska, k√§rlek, illam√•ende, h√•ll och tandv√§rk √§r ocks√• substantiv."
          },
          {
            "id": "item-1755384876559",
            "type": "question",
            "order": 3,
            "content": "Vilket ord √§r ett substantiv\n\nGl√§djen fyllde hela rummet.",
            "alternatives": [
              {
                "text": "Gl√§djen",
                "correct": true
              },
              {
                "text": "Fyllde",
                "correct": false
              },
              {
                "text": "Hela",
                "correct": false
              },
              {
                "text": "rummet",
                "correct": false
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          },
          {
            "id": "item-1755384960258",
            "type": "question",
            "order": 4,
            "content": "Vilket ord √§r ett substantiv\n\nHan fylldes av ilska",
            "alternatives": [
              {
                "text": "Han",
                "correct": false
              },
              {
                "text": "Fylldes",
                "correct": false
              },
              {
                "text": "Av",
                "correct": false
              },
              {
                "text": "Ilska",
                "correct": true
              }
            ],
            "correctFeedback": "R√§tt! Bra jobbat!",
            "incorrectFeedback": "Fel svar. F√∂rs√∂k igen!"
          },
          {
            "id": "item-1755379699695",
            "type": "text",
            "order": 5,
            "content": "Toppenbra jobbat! Nu har det √§ntligen dags f√∂r ditt slutprov!"
          }
        ],
        "animationSpeed": 25,
        "characterImage": "/@fs/home/runner/workspace/attached_assets/Pirat%20h%C3%B6ger_1755326212023.png"
      }
    },
    {
      "id": "merged2_1755383020389_4",
      "type": "slutprov",
      "order": 4,
      "title": "Slutprov",
      "config": {
        "sentences": [
          "Jag har en anka",
          "Min nya bil vill inte starta",
          "Titta en skog!",
          "Solstolen v√§lte genast",
          "Kalmar vann inte ig√•r",
          "Jag spillde p√• mina byxor!",
          "Gl√§djen sprider sig",
          "Frankrike √§r fint",
          "Inska √§r tr√•kigt",
          "Zebran sprang iv√§g",
          "Spring Jonas, spring!",
          "Se p√• havet!",
          "Min katt √§r den finaste!",
          "Jag har k√∂pt en ny cykel",
          "K√§rlek √§r fint"
        ],
        "timeLimit": 120,
        "instruction": "Klicka p√• substantivet i meningen",
        "targetWords": [
          "anka",
          "bil",
          "skog!",
          "Solstolen",
          "Kalmar",
          "byxor!",
          "Gl√§djen",
          "Frankrike",
          "Ilska",
          "Zebran",
          "Jonas",
          "Havet",
          "katt",
          "Cykel",
          "K√§rlek"
        ],
        "penaltySeconds": 10,
        "requiredCorrect": 12
      }
    },
    {
      "id": "moment_1755411742452",
      "type": "slutdiplom",
      "order": 5,
      "title": "Slutdiplom",
      "config": {
        "courseName": "Substantiv - del 1 "
      }
    }
  ],
  "wordClass": "noun",
  "background": "beach"
};
        
        function LessonPlayer() {
            const [currentMomentIndex, setCurrentMomentIndex] = useState(0);
            const [currentText, setCurrentText] = useState("");
            const [textIndex, setTextIndex] = useState(0);
            const [currentItemIndex, setCurrentItemIndex] = useState(0);
            const [itemCompleted, setItemCompleted] = useState(false);
            const [showFeedback, setShowFeedback] = useState(false);
            const [feedbackText, setFeedbackText] = useState('');
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            
            const currentMoment = lessonData.moments[currentMomentIndex];
            
            // Reset states when moment or item changes
            useEffect(() => {
                if (currentMoment?.type === 'pratbubbla') {
                    setTextIndex(0);
                    setCurrentText('');
                    setItemCompleted(false);
                    setShowFeedback(false);
                    setSelectedAnswer(null);
                }
            }, [currentMomentIndex, currentItemIndex]);
            
            // Get current item based on index
            const getCurrentItem = () => {
                if (currentMoment?.type === 'pratbubbla' && currentMoment.config.items && currentMoment.config.items.length > 0) {
                    const sortedItems = [...currentMoment.config.items].sort((a, b) => a.order - b.order);
                    return sortedItems[currentItemIndex] || null;
                }
                return null;
            };
            
            // Typewriter effect
            useEffect(() => {
                if (currentMoment?.type === 'pratbubbla') {
                    const currentItem = getCurrentItem();
                    let text = '';
                    
                    if (currentItem && (currentItem.type === 'text' || currentItem.type === 'question')) {
                        text = currentItem.content || '';
                    } else if (!currentMoment.config.items) {
                        text = currentMoment.config.text || '';
                    }
                    
                    if (text && textIndex < text.length) {
                        const timeout = setTimeout(() => {
                            setCurrentText(text.slice(0, textIndex + 1));
                            setTextIndex(textIndex + 1);
                        }, currentMoment.config.animationSpeed || 50);
                        return () => clearTimeout(timeout);
                    } else if (text && textIndex >= text.length) {
                        setItemCompleted(true);
                    }
                }
            }, [textIndex, currentMoment, currentItemIndex]);
            
            const handleAnswerSelect = (answer, isCorrect) => {
                setSelectedAnswer(answer);
                setShowFeedback(true);
                
                const currentItem = getCurrentItem();
                if (isCorrect) {
                    setFeedbackText(currentItem?.correctFeedback || 'R√§tt! Bra jobbat!');
                } else {
                    setFeedbackText(currentItem?.incorrectFeedback || 'Fel svar. F√∂rs√∂k igen!');
                }
            };
            
            const resetQuestion = () => {
                setSelectedAnswer(null);
                setShowFeedback(false);
                setFeedbackText('');
            };
            
            const goToNextItem = () => {
                if (currentMoment.config.items && currentMoment.config.items.length > 0) {
                    const sortedItems = [...currentMoment.config.items].sort((a, b) => a.order - b.order);
                    if (currentItemIndex < sortedItems.length - 1) {
                        setCurrentItemIndex(currentItemIndex + 1);
                    } else {
                        goToNextMoment();
                    }
                } else {
                    goToNextMoment();
                }
            };
            
            const goToNextMoment = () => {
                if (currentMomentIndex < lessonData.moments.length - 1) {
                    setCurrentMomentIndex(currentMomentIndex + 1);
                    setCurrentItemIndex(0);
                }
            };
            
            const isLastItem = () => {
                if (currentMoment?.type === 'pratbubbla' && currentMoment.config.items && currentMoment.config.items.length > 0) {
                    const sortedItems = [...currentMoment.config.items].sort((a, b) => a.order - b.order);
                    return currentItemIndex === sortedItems.length - 1;
                }
                return false;
            };
            
            if (!currentMoment) {
                return React.createElement('div', {
                    className: 'flex items-center justify-center h-screen text-2xl'
                }, 'Lektion slutf√∂rd! üéâ');
            }
            
            if (currentMoment.type === 'pratbubbla') {
                const currentItem = getCurrentItem();
                const isCurrentItemQuestion = currentItem?.type === 'question';
                const isCurrentItemText = currentItem?.type === 'text';
                
                let hasQuestion = false;
                let currentAlternatives = [];
                
                if (isCurrentItemQuestion) {
                    hasQuestion = true;
                    currentAlternatives = currentItem?.alternatives || [];
                } else if (!currentMoment.config.items && currentMoment.config.question && currentMoment.config.alternatives) {
                    hasQuestion = true;
                    currentAlternatives = currentMoment.config.alternatives || [];
                }
                
                const textComplete = (isCurrentItemText || isCurrentItemQuestion) ? itemCompleted : true;
                
                return React.createElement('div', {
                    className: 'w-full h-screen flex',
                    style: { minHeight: '100vh' }
                }, 
                    // Text area - 3/4 of screen
                    React.createElement('div', {
                        className: 'w-3/4 flex items-start justify-center pt-16 p-8'
                    },
                        React.createElement('div', {
                            className: 'bg-white rounded-2xl p-8 shadow-lg max-w-3xl w-full',
                            style: { border: '4px solid #93c5fd' }
                        },
                            React.createElement('div', {
                                className: 'speech-bubble'
                            },
                                // Text content
                                React.createElement('p', {
                                    className: 'text-2xl leading-relaxed whitespace-pre-wrap'
                                }, 
                                    showFeedback ? feedbackText : currentText,
                                    !showFeedback && (isCurrentItemText || isCurrentItemQuestion) && !itemCompleted && 
                                        React.createElement('span', { className: 'animate-pulse' }, '|')
                                ),
                                
                                // Question and alternatives
                                hasQuestion && isCurrentItemQuestion && textComplete && !showFeedback &&
                                    React.createElement('div', { className: 'mt-6' },
                                        React.createElement('div', { className: 'space-y-3' },
                                            currentAlternatives.map((alt, index) =>
                                                React.createElement('button', {
                                                    key: index,
                                                    className: 'w-full text-left justify-start p-4 h-auto bg-white border border-gray-300 rounded hover:bg-gray-50',
                                                    onClick: () => handleAnswerSelect(alt.text, alt.correct),
                                                    disabled: selectedAnswer !== null
                                                }, alt.text)
                                            )
                                        )
                                    ),
                                
                                // Feedback actions
                                showFeedback &&
                                    React.createElement('div', { className: 'mt-4 space-x-3' },
                                        !currentAlternatives.find(alt => alt.text === selectedAnswer)?.correct ? 
                                            React.createElement('button', {
                                                className: 'px-4 py-2 border border-gray-300 rounded hover:bg-gray-50',
                                                onClick: resetQuestion
                                            }, 'F√∂rs√∂k igen') :
                                            isLastItem() ?
                                                React.createElement('button', {
                                                    className: 'px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600',
                                                    onClick: goToNextMoment
                                                }, 'Slutf√∂r momentet') :
                                                React.createElement('button', {
                                                    className: 'px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600',
                                                    onClick: goToNextItem
                                                }, 'N√§sta')
                                    ),
                                
                                // Continue button for text items
                                !hasQuestion && itemCompleted && !isLastItem() &&
                                    React.createElement('div', { className: 'mt-4' },
                                        React.createElement('button', {
                                            className: 'px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600',
                                            onClick: goToNextItem
                                        }, 'Forts√§tt')
                                    ),
                                
                                // Final button for last text item
                                !hasQuestion && itemCompleted && isLastItem() &&
                                    React.createElement('div', { className: 'mt-4' },
                                        React.createElement('button', {
                                            className: 'px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600',
                                            onClick: goToNextMoment
                                        }, 'Slutf√∂r momentet')
                                    )
                            )
                        )
                    ),
                    
                    // Character area - 1/4 of screen  
                    React.createElement('div', {
                        className: 'w-1/4 flex items-center justify-center p-8'
                    },
                        React.createElement('div', { className: 'text-center' },
                            React.createElement('div', {
                                className: 'mb-4',
                                style: { fontSize: '8rem' }
                            }, 'üè¥‚Äç‚ò†Ô∏è'),
                            React.createElement('div', {
                                className: 'bg-white rounded-lg p-4 shadow-lg'
                            },
                                React.createElement('p', {
                                    className: 'font-bold text-gray-700'
                                }, currentMoment.config.characterName || 'Kapten Matilda')
                            )
                        )
                    )
                );
            }
            
            // Other moment types can be handled here
            return React.createElement('div', {
                className: 'p-8'
            }, 
                React.createElement('h2', { className: 'text-2xl font-bold mb-4' }, currentMoment.title),
                React.createElement('p', null, 'Moment typ: ' + currentMoment.type),
                React.createElement('button', {
                    className: 'mt-4 px-4 py-2 bg-blue-500 text-white rounded',
                    onClick: goToNextMoment
                }, 'N√§sta moment')
            );
        }
        
        ReactDOM.render(React.createElement(LessonPlayer), document.getElementById('root'));
    </script>
</body>
</html>