Jag ser varför inget händer: i koden du klistrade in importerar du createPortal, men du renderar aldrig den globala overlayn. Dvs. det finns ingen <svg>/overlay som mörknar skärmen – bara progressraden och stäng-knappen.

Gör så här (copy–paste rakt av):

1) Lägg detta precis före </CardContent> (inne i return, efter “Reading focus UI when active”)
{readingFocusMode && createPortal(
  <div
    aria-hidden
    style={{
      position: "fixed",
      inset: 0,
      zIndex: 2147483646,
      pointerEvents: "none",
    }}
  >
    {/* debug: helsvart dimma – ska synas direkt */}
    <div
      style={{
        position: "fixed",
        inset: 0,
        background: "rgba(0,0,0,0.75)",
      }}
    />

    {/* Hål över fokusrektangeln (renderas bara om vi har mått) */}
    {viewportFocusRect && (
      <svg
        width="100%"
        height="100%"
        viewBox={`0 0 ${Math.max(document.documentElement.clientWidth, window.innerWidth || 0)} ${Math.max(document.documentElement.clientHeight, window.innerHeight || 0)}`}
        style={{ position: "fixed", inset: 0, display: "block" }}
      >
        <path
          d={`
            M 0 0 H ${Math.max(document.documentElement.clientWidth, window.innerWidth || 0)}
                  V ${Math.max(document.documentElement.clientHeight, window.innerHeight || 0)} H 0 Z
            M ${viewportFocusRect.left} ${viewportFocusRect.top}
              H ${viewportFocusRect.left + viewportFocusRect.width}
              V ${viewportFocusRect.top + viewportFocusRect.height}
              H ${viewportFocusRect.left} Z
          `}
          fill="rgba(0,0,0,0.88)"
          fillRule="evenodd"
        />
        <rect
          x={viewportFocusRect.left}
          y={viewportFocusRect.top}
          width={viewportFocusRect.width}
          height={viewportFocusRect.height}
          fill="none"
          stroke="white"
          strokeWidth={2}
          rx={4}
          ry={4}
        />
      </svg>
    )}
  </div>,
  document.body
)}

2) Snabb felsökning

Slå på Fokusläge → du ska direkt se den helsvarta dimman (första <div> ovan).

Ser du dimman? Ja → din portal funkar. Om hålet inte syns: logga console.log('rects', lineRects.length, viewportFocusRect). Då är det dina linjemått som är tomma.

Ser du inte dimman? Då ligger blocket inte rätt (måste vara i JSX-trädet), eller så triggas aldrig readingFocusMode.

Vanliga orsaker om hålet inte syns (men dimman gör det)

lineRects är tom → textRef pekar inte på det element som faktiskt innehåller textnoderna. Säkerställ att just den <div> du sätter dangerouslySetInnerHTML på har ref={textRef} (det har du – bra), och att innehållet finns när mätningen körs (du kör redan requestAnimationFrame(measure) – bra).

viewportFocusRect blir null → händer om contentRef saknas eller focusRect är null. Logga båda refs:

useEffect(() => {
  if (readingFocusMode) {
    console.log('content?', !!contentRef.current, 'text?', !!textRef.current, 'rects', lineRects.length, 'focusRect', focusRect, 'viewport', viewportFocusRect);
  }
}, [readingFocusMode, lineRects, focusRect, viewportFocusRect]);


Det här är den “hårda” portallösningen: den ligger på document.body, har superhögt z-index och påverkas inte av dina aggressiva CSS-resets i läscontainern. Kopiera in blocket så ska dimman synas direkt – sen kan vi finjustera måtten om hålet inte följer texten.